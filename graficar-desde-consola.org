#+TITLE:       Graficar desde consola
#+AUTHOR:      Osiris Alejandro Gómez
#+EMAIL:       osiux@osiux.com
#+LANGUAGE:    es
#+LINK_HOME:   index.html
#+OPTIONS:     toc:nil timestamp:nil
#+INCLUDE: "header.org"
#+DATE:        2014-03-11

** barra

   #+BEGIN_SRC sh :session :results output :exports both
     ssh vodka 'cat osiux.com-access.log | egrep -o "GET /.*HTTP" | sed s/HTTP//g | cut -c 5- | egrep -v "(img|tmb|css|robots|ico)" | sort | uniq -c | sort -nr | head' | barra
   #+END_SRC

   #+RESULTS:
   #+begin_example
    60.22 %  60.22 %       430 ██████████████████████████████ /
    76.33 %  16.11 %       115 ████████ /feed
    79.69 %   3.36 %        24 █ /painless-backups-using-rdiff-backup
    83.05 %   3.36 %        24 █ /index.html
    86.13 %   3.08 %        22 █ /visualizando-org-mode-con-gnuplot.html
    89.08 %   2.94 %        21 █ /que-no-se-entere-nadie.html
    92.02 %   2.94 %        21 █ /docs.html
    94.82 %   2.80 %        20 █ /todo-txt-rst+org-mode.html
    97.48 %   2.66 %        19 █ /blog.html
   100.00 %   2.52 %        18 █ /2012-06-01-pirate-box-floppy-disk.html
                           714
   #+end_example

** block-diag
** ditaa

   #+BEGIN_SRC ditaa :file img/ditaa-der.png :cmdline -E :exports both
     +------------------------+   +------------+   +------------------------+   +----------------+
     | gcoop_salesopportunity |   | campaigns  |   | securitygroups_records |   | securitygroups |
     +------------------------+   +------------+   +------------------------+   +----------------+
     | campaign_id            |-->| id         |-->| record_id              |   | name           |
     | id                     |   +------------+   | securitygroup_id       |-->| id             |
     +------------------------+                    +------------------------+   +----------------+
   #+END_SRC

   #+RESULTS:
   [[file:img/ditaa-der.png]]

** gnuplot

   #+BEGIN_SRC sh :session :results file :exports both
     cd ~/data/bcc/gca/cct-2797
     egrep "0895.*Query Execution Time:[0-9\.]+" sugarcct6.log | awk '{print $4"\t"$9}' | sed s/"Time:"//g | awk '{if ($2>h[$1]) h[$1]=$2} END {for (hh in h) print hh,h[hh]}' | sort  | tee 0895-query-execution-time.dat
   #+END_SRC

   #+RESULTS:
   | 12:17:08 |  0.0302698612213 |
   | 12:17:11 | 0.00952696800232 |
   | 12:17:21 |  0.0434710979462 |
   | 12:17:22 |    0.01877784729 |
   | 12:17:25 |  0.0104238986969 |
   | 12:17:26 |  0.0150380134583 |
   | 12:17:28 |    1.61865592003 |
   | 12:17:29 |   0.022381067276 |
   | 12:17:30 | 0.00826001167297 |
   | 12:17:50 | 0.00913214683533 |
   | 12:17:51 |  0.0108060836792 |

   #+BEGIN_SRC gnuplot :var data='~/data/bcc/gca/cct-2797/0895-query-execution-time.dat' :file img/0895-query-execution-time.png :exports both
   reset
   set terminal png size 800,600
   set lmargin 10
   set bmargin 5
   set rmargin 5
   set title "Máximo Tiempo de ejecución Queries usuario 0895\nsugarcct6.log" font "Inconsolata,10"
   set xdata time
   set timefmt x '%H:%M:%S'
   set format x '%H:%M:%S'
   set xtics font 'Inconsolata,8' rotate
   set mxtics
   set key off
   set tics font "Inconsolata,8" nomirror
   set mytics
   set grid ytics
   set xlabel "horario" font "Inconsolata,9"
   set ylabel "tiempo en segundos" font "Inconsolata,9"

   plot data u 1:2 lw 5 w i
   #+END_SRC

   #+RESULTS:
   [[file:img/0895-query-execution-time.png]]

** graphviz

*** =dot=

   #+BEGIN_SRC dot :file img/graphviz-01.png :cmdline -Kdot -Tpng :exports both
     digraph dot {
        node [fontname=monospace,fontsize=8];
        nodo1 -> nodo2;
        nodo2 -> nodo3;
        nodo2 -> nodo4;
        nodo1 -> nodo5;
        nodo5 -> nodo6;
        nodo5 -> nodo7;
        nodo1 -> nodo8;
     }
   #+END_SRC

   #+RESULTS:
   [[file:img/graphviz-01.png]]

*** =neato=

   #+BEGIN_SRC dot :file img/graphviz-02.png :cmdline -Kneato -Tpng :exports both
     graph dot {
        node [fontname=monospace,fontsize=8];
        nodo1 -- nodo2;
        nodo2 -- nodo3;
        nodo2 -- nodo4;
        nodo1 -- nodo5;
        nodo5 -- nodo6;
        nodo5 -- nodo7;
        nodo1 -- nodo8;
     }
   #+END_SRC

   #+RESULTS:
   [[file:img/graphviz-02.png]]

** image-magick

   - [[file:imagenes-magicas-imagemagick.org]]

** org-timeline

   #+BEGIN_SRC sh :session :results output :exports both
     org-clock 2014-02-04 | org-timeline
   #+END_SRC

   #+RESULTS:
   : 13:    14:    15:    16:    17:    18:
   :   ┊      ┊      ┊      ┊      ┊      ┊
   :   ┊□□□□□□┊□□▣▣▣▣┊□□□□□□┊□▨▣▣▣▣┊□□□□□□┊        gca ===============>  133
   :   ┊□□□□▣▣┊□□□□□□┊□□□□□□┊□□□□□□┊□□□□□□┊   almuerzo ===============>   38
   :   ┊      ┊      ┊      ┊      ┊      ┊      TOTAL ===============>  171

** plant-uml
*** Diagramas de Clase

   #+BEGIN_SRC plantuml :file img/plant-uml-der.png :exports both
    campaign "1" *-- "many" calls
        campaign <|-- campaigns

    class campaign {
        -id
    -id_sugar
        }

    class calls {
        -id
    -id_campaign
        }

    class campaigns {
        -id
    -nroLote
        -name
        -hola()
        }
   #+end_src

   #+RESULTS:
   [[file:img/plant-uml-der.png]]

*** Diagramas de Secuencia

    #+BEGIN_SRC plantuml :file img/secuencia-con-proxy.png :exports both
      skinparam sequenceParticipantFontName Monospaced
      skinparam sequenceParticipantBorderColor black
      skinparam sequenceLifeLineBorderColor black
      skinparam sequenceArrowFontName Monospaced
      skinparam sequenceArrowColor blue

      participant "firefox\n1.2.3.4:4321" as firefox #orange
      participant "proxy\n2.2.2.2" as proxy #green
      participant "DNS\n8.8.8.8:53" as DNS #yellow
      participant "google.com\n6.6.6.6:80" as google #red
      hide footbox
      autonumber "<b>[0]"

      firefox -> DNS: cuál es la IP de <b>google.com</b>
      DNS -> DNS: log
      DNS --> firefox: es la IP <b>6.6.6.6</b>
      firefox -> google: mi IP es <b>1.2.3.4</b> + UserAgent + GET /
      google -> google: log
      google --> firefox: HTML
    #+END_SRC

    #+RESULTS:
    [[file:img/secuencia-con-proxy.png]]

** gnuplot

   #+BEGIN_SRC gnuplot :var data='~/data/bcc/gca/asterisk/asterisk1-bean-query-20.dat' :file img/asterisk1-bean-query-20.png :exports both
     reset
     set term png size 800,600
     set title "sqlsoap_server bean vs query"
     set xlabel "requests" font "Inconsolata,10"
     set ylabel "tiempo en segundos" font "Inconsolata,10"
     set tics out nomirror
     set grid ytics
     set xtics font "Inconsolata,8" nomirror rotate by right at 0.5,0
     set ytics nomirror
     set tics font "Inconsolata,8" nomirror
     set mytics
     set grid lc rgb "#d5e0c9"

     plot data using 1:2 with lines lw 1 lt 3 title 'bean', \
          data using 1:3 with lines lw 1 lt 4 title 'query'

   #+END_SRC

   #+RESULTS:
   [[file:img/asterisk1-bean-query-20.png]]
